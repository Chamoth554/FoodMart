!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var r in i)("object"==typeof exports?exports:t)[r]=i[r]}}(Depicter,(()=>(()=>{"use strict";var t={};(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);const{Layer:e,env:i}=window.Depicter;return window.Depicter.externalLayers.form=class extends e{constructor(t,e,r,s,o,n){super(t,e,r,s,o,n),this.type="form",this.nestable=!0,this.frame.classList.add(`${i.prefix}-${this.type}-layer`),this.resetAfterSubmit="false"!==this.element.getAttribute("data-reset-after-submit"),this.element.addEventListener("submit",(t=>{t.preventDefault(),this._onFormSubmit()})),this.isSubmitting=!1}async _onFormSubmit(){if(this.isSubmitting)return;const t=new FormData(this.element),e=this.element.querySelector('[type="submit"]');e?.classList.add("depicter-is-loading"),await this._sendForm(t),e?.classList.remove("depicter-is-loading"),this.isSubmitting=!1}async _sendForm(t){this.isSubmitting=!0;const e=this.element.getAttribute("action");try{this.trigger("formSubmit",[this]);const i=await fetch(e,{method:"POST",body:t}),r=await i.json();r.success?(this.resetAfterSubmit&&this.element.reset(),this.trigger("formSubmitted",[this,r]),this.composer.trigger("formSubmitted",[this,r])):(this.trigger("formSubmitError",[this,r]),this.composer.trigger("formSubmitError",[this,r]))}catch(t){this.trigger("formSubmitError",[this,t]),this.composer.trigger("formSubmitError",[this,t]),console.error(t)}}},t})()));